<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>物业管理</title>

    <script src="/kendoui/kendoui/js/jquery.min.js"></script>
    <script src="/kendoui/kendoui/js/kendo.all.min.js"></script>
    <link href="/kendoui/bootstrap-3.3.7/css/bootstrap.css" rel="stylesheet" type="text/css"/>
    <link href="/kendoui/font-awesome-4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/>
    <link href="/kendoui/kendoui/styles/kendo.common-bootstrap.min.css" rel="stylesheet" type="text/css"/>
    <link href="/kendoui/kendoui/styles/kendo.bootstrap.min.css" rel="stylesheet" type="text/css"/>
    <link href="/kendoui/kendoui/styles/kendo.hap.css" rel="stylesheet" type="text/css"/>
    <script src="/kendoui/kendoui/js/kendo.hap.js"></script>
    <script src="/kendoui/polyfill/es5-shim.min.js"></script>
    <script src="/kendoui/polyfill/respond.min.js"></script>

</head>
<body>
<script type="text/javascript">
    var viewModel = kendo.observable({
        model:{
            userInfo:{},
        },
        createFunction: function(){
            $('#Grid').data('kendoGrid').addRow();
        },
        saveFunction: function(){
            $('#Grid').data('kendoGrid').saveChanges();
        },
        queryResource: function(e) {
            $('#Grid').data('kendoGrid').dataSource.page(1);
        }

    });

</script>
<div id="base">
    <div class="demo-section k-content" style="width: 98%;">
        <div id="tabstrip">
            <div>
                <div class="panel" style="padding: 0px;">
                    <form class="form-horizontal" style="width: 100%;height: 505px">
                        <div id="baseInfo" class="panel-body" style="">

                            <div style="margin-bottom: 10px;margin-top: 5px">
                                <span class="btn btn-primary" style="width: 150px">户主基本信息</span>
                            </div>

                            <div class="row">

                                <div class="col-sm-4" id="1">
                                    <div class="form-group">
                                        <label class="col-sm-4 control-label">户主姓名</label>
                                        <div class="col-sm-8">
                                            <input id="userName" name="userName" data-bind="value:model.userInfo.userName" type="text" style="width: 100%" class="k-textbox">
                                        </div>
                                        <script>
                                            $("#userName").attr("required", true);
                                        </script>
                                    </div>
                                </div>

                                <div class="col-sm-4" id="2">
                                    <div class="form-group">
                                        <label class="col-sm-4 control-label">账号</label>
                                        <div class="col-sm-8">
                                            <input id="userAccount" name="userAccount" data-bind="value:model.userInfo.userAccount" type="text" style="width: 100%" class="k-textbox">
                                        </div>
                                    </div>
                                </div>

                                <div class="col-sm-4" id="3">
                                    <div class="form-group">
                                        <label class="col-sm-4 control-label">民族</label>
                                        <div class="col-sm-8">
                                            <input id="userNational" name="userNational" data-bind="value:model.userInfo.userNational" type="text" style="width: 100%" class="k-textbox">
                                        </div>
                                    </div>
                                </div>

                            </div>

                            <div class="row">

                                <div class="col-sm-4" id="4">
                                    <div class="form-group">
                                        <label class="col-sm-4 control-label">性别</label>
                                        <div class="col-sm-8">
                                            <input id="userGender" name="userGender" data-bind="value:model.userInfo.userGender" type="text" style="width: 100%">
                                        </div>
                                    </div>
                                    <script>
                                        var gender = 'gender';
                                        $.ajax({
                                            type : "GET" ,
                                            url: "/ci/selectByType",
                                            dataType: "json",
                                            data:{commonType : gender},
                                            success: function (data) {
                                                if (data.success) {
                                                    commonInfoSource = eval(data.rows);
                                                    $("#userGender").kendoComboBox({
                                                        dataTextField: "commonName",
                                                        dataValueField: "commonValue",
                                                        dataSource: commonInfoSource,
                                                    });
                                                }
                                            }
                                        });
                                    </script>
                                </div>

                                <div class="col-sm-4" id="5">
                                    <div class="form-group">
                                        <label class="col-sm-4 control-label">籍贯</label>
                                        <div class="col-sm-8">
                                            <input id="userNativePlace" name="userNativePlace" data-bind="value:model.userInfo.userNativePlace" type="text" style="width: 100%" class="k-textbox">
                                        </div>
                                    </div>
                                </div>

                                <div class="col-sm-4" id="6">
                                    <div class="form-group">
                                        <label class="col-sm-4 control-label">身份证号</label>
                                        <div class="col-sm-8">
                                            <input id="userIdNumber" name="userIdNumber" data-bind="value:model.userInfo.userIdNumber" type="text" style="width: 100%" class="k-textbox">
                                        </div>
                                    </div>
                                </div>

                            </div>

                            <div class="row">

                                <div class="col-sm-4" id="7">
                                    <div class="form-group">
                                        <label class="col-sm-4 control-label">身份证地址</label>
                                        <div class="col-sm-8">
                                            <input id="userHomeAddress" name="userHomeAddress" data-bind="value:model.userInfo.userHomeAddress" type="text" style="width: 100%" class="k-textbox">
                                        </div>
                                    </div>
                                </div>

                                <div class="col-sm-4" id="8">
                                    <div class="form-group">
                                        <label class="col-sm-4 control-label">通讯地址</label>
                                        <div class="col-sm-8">
                                            <input id="userCorrespondenceAddress" name="userCorrespondenceAddress" data-bind="value:model.userInfo.userCorrespondenceAddress"  type="text" style="width: 100%" class="k-textbox">
                                        </div>
                                    </div>
                                </div>

                                <div class="col-sm-4" id="9">
                                    <div class="form-group">
                                        <label class="col-sm-4 control-label">工作职位</label>
                                        <div class="col-sm-8">
                                            <input id="userDepartment" name="userDepartment" data-bind="value:model.userInfo.userDepartment" type="text" style="width: 100%" class="k-textbox">
                                        </div>
                                    </div>
                                </div>

                            </div>

                            <div class="row">

                                <div class="col-sm-4" id="10">
                                    <div class="form-group">
                                        <label class="col-sm-4 control-label">工作单位</label>
                                        <div class="col-sm-8">
                                            <input id="userWorkUnits" name="userWorkUnits" type="text" style="width: 100%" data-bind="value:model.userInfo.userWorkUnits" class="k-textbox">
                                        </div>
                                    </div>
                                </div>

                                <div class="col-sm-4" id="11">
                                    <div class="form-group">
                                        <label class="col-sm-4 control-label">汽车牌号</label>
                                        <div class="col-sm-8">
                                            <input id="userCarBrand" name="userCarBrand"  type="text" style="width: 100%" data-bind="value:model.userInfo.userCarBrand" class="k-textbox">
                                        </div>
                                    </div>
                                </div>

                                <div class="col-sm-4" id="12">
                                    <div class="form-group">
                                        <label class="col-sm-4 control-label">兴趣爱好</label>
                                        <div class="col-sm-8">
                                            <input id="userHobby" name="userHobby" type="text" style="width: 100%" data-bind="value:model.userInfo.userHobby" class="k-textbox">
                                        </div>
                                    </div>
                                </div>

                            </div>

                            <div style="margin-bottom: 10px;margin-top: 5px">
                                <span class="btn btn-primary" style="width: 150px">联系方式</span>
                            </div>
                            <div class="row">
                                <div class="col-sm-4" id="16">
                                    <div class="form-group">
                                        <label class="col-sm-4 control-label">固定电话</label>
                                        <div class="col-sm-8">
                                            <input id="fixedTelephone" name="fixedTelephone" type="text" style="width: 100%" data-bind="value:model.userInfo.fixedTelephone" class="k-textbox">
                                        </div>
                                    </div>
                                </div>
                                <div class="col-sm-4" id="17">
                                    <div class="form-group">
                                        <label class="col-sm-4 control-label">QQ</label>
                                        <div class="col-sm-8">
                                            <input id="userQq" name="userQq" type="text" style="width: 100%" data-bind="value:model.userInfo.userQq" class="k-textbox">
                                        </div>
                                    </div>
                                </div>
                                <div class="col-sm-4" id="18">
                                    <div class="form-group">
                                        <label class="col-sm-4 control-label">邮箱</label>
                                        <div class="col-sm-8">
                                            <input id="userEmail" name="userEmail" type="text" style="width: 100%" data-bind="value:model.userInfo.userEmail" class="k-textbox">
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-sm-4" id="19">
                                    <div class="form-group">
                                        <label class="col-sm-4 control-label">手机号</label>
                                        <div class="col-sm-8">
                                            <input id="userPhone" name="userPhone" type="text" style="width: 100%" data-bind="value:model.userInfo.userPhone" class="k-textbox">
                                        </div>
                                    </div>
                                </div>
                                <div class="col-sm-4" id="20">
                                    <div class="form-group">
                                        <label class="col-sm-4 control-label">微信号</label>
                                        <div class="col-sm-8">
                                            <input id="userWeChat" name="userWeChat" type="text" style="width: 100%" data-bind="value:model.userInfo.userWeChat" class="k-textbox">
                                        </div>
                                    </div>
                                </div>
                                <div class="col-sm-4" id="21">
                                    <div class="form-group">
                                        <label class="col-sm-4 control-label">博客</label>
                                        <div class="col-sm-8">
                                            <input id="userBlog" name="userBlog" type="text" style="width: 100%" data-bind="value:model.userInfo.userBlog" class="k-textbox">
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-sm-4" id="22">
                                    <div class="form-group">
                                        <label class="col-sm-4 control-label">紧急联系人</label>
                                        <div class="col-sm-8">
                                            <input id="emergencyContact" name="emergencyContact" type="text" style="width: 100%" data-bind="value:model.userInfo.emergencyContact" class="k-textbox">
                                        </div>
                                    </div>
                                </div>
                                <div class="col-sm-4" id="23">
                                    <div class="form-group">
                                        <label class="col-sm-4 control-label">紧急联系人电话</label>
                                        <div class="col-sm-8">
                                            <input id="emergencyContactPhone" name="emergencyContactPhone" type="text" style="width: 100%" data-bind="value:model.userInfo.emergencyContactPhone" class="k-textbox">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="panel-footer text-right">
                            <span class="btn btn-success" onclick="saveUserInfo()">保存</span>
                            <span class="btn btn-primary" onclick="resetPwd()">密码重置</span>
                        </div>
                    </form>
                </div>
            </div>
        </div>
        <script>kendo.bind($('#tabstrip'), viewModel);</script>
    </div>

    <style>
        .sunny, .cloudy, .rainy {
            display: block;
            margin: 30px auto 10px;
            width: 128px;
            height: 128px;
        }

        .cloudy{
            background-position: -128px 0;
        }

        .rainy{
            background-position: -256px 0;
        }

        .weather {
            margin: 0 auto 30px;
            text-align: center;
        }

        #tabstrip h2 {
            font-weight: lighter;
            font-size: 5em;
            line-height: 1;
            padding: 0 0 0 30px;
            margin: 0;
        }

        #tabstrip h2 span {
            background: none;
            padding-left: 5px;
            font-size: .3em;
            vertical-align: top;
        }

        #tabstrip p {
            margin: 0;
            padding: 0;
        }
    </style>

    <script>
        var userId= JSON.parse(window.localStorage["userIdInfo"]);//user_ID
        //时间格式化
        function dateStr(oDate) {
            oYear = oDate.getFullYear(),
                oMonth = oDate.getMonth()+1,
                oDay = oDate.getDate(),
                oHour = oDate.getHours(),
                oMin = oDate.getMinutes(),
                oSen = oDate.getSeconds(),
                oTime = oYear +'-'+ getzf(oMonth) +'-'+ getzf(oDay);//最后拼接时间
            return oTime;
        }
        function getzf(num){
            if(parseInt(num) < 10){
                num = '0'+num;
            }
            return num;
        }

        $.ajax({
            type: 'POST',
            url: '/mm/selectByUserId',
            dataType: "json",
            data:{userId:userId},
            success: function (data) {
                viewModel.model.set('userInfo', data.rows[0]);
                gender = viewModel.model.userInfo.userGender;
                $("#userGender").data("kendoComboBox").value(gender);
                /*object = viewModel.model.userInfo.object;
                $("#object").data("kendoComboBox").value(object);*/
            }
        });

        function saveUserInfo(){
            userGender = $("#userGender").val();
            viewModel.model.userInfo.set('userGender',userGender);
            var userInfo = JSON.stringify(viewModel.model.userInfo);
            $.ajax({
                type: 'POST',
                url: '/mm/saveUserInfo',
                dataType: "json",
                contentType: "application/json",
                data: userInfo,
                success: function (data) {
                    if (data.success) {
                        alert("保存成功！")
                    }
                }
            });
        }

        function resetPwd() {
            window.open ("../resetPwd.html", "newwindow","toolbar=no, location=no, directories=no, status=no," +
                " menubar=no, scrollbars=no, resizable=no, copyhistory=no, width=800, height=400, left=240, top=40");
        }
    </script>
</div>

</body>
</html>


